services:
  onfuture-web:
    image: ghcr.io/aliyabuz25/onfuturelast:latest
    restart: unless-stopped
    environment:
      PORT: "6985"
      HOST: "0.0.0.0"
    volumes:
      - /datastore/onfuture-web/data:/app/data
      - /datastore/onfuture-web/uploads:/app/assets/uploads
      - /datastore/onfuture-web/logs.json:/app/logs.json
    networks:
      - edge
    labels:
      - 'traefik.enable=true'
      - 'traefik.docker.network=edge'
      # API, Data & Media Router (Priority 100)
      - 'traefik.http.routers.onfuture-api.rule=(Host(`onfuture.az`) || Host(`www.onfuture.az`)) && (PathPrefix(`/api`) || PathPrefix(`/assets/uploads`) || PathPrefix(`/cdn`) || PathPrefix(`/data`))'
      - 'traefik.http.routers.onfuture-api.entrypoints=web'
      - 'traefik.http.routers.onfuture-api.priority=100'
      - 'traefik.http.services.onfuture-web.loadbalancer.server.port=6985'
      # Main Frontend Router
      - 'traefik.http.routers.onfuture.rule=Host(`onfuture.az`) || Host(`www.onfuture.az`)'
      - 'traefik.http.routers.onfuture.entrypoints=web'
      - 'traefik.http.services.onfuture-web.loadbalancer.server.port=6985'

networks:
  edge:
    external: true
